/**
 * 격려 멘트 데이터 및 유틸리티 함수
 */

import type { EncouragementMessages } from './types';

export const ENCOURAGEMENT_MESSAGES: EncouragementMessages[] = [
  {
    level: '하위권',
    messages: [
      '수학은 계단입니다. 한 칸씩 차근차근 오르면 반드시 정상에 도착합니다.',
      '지금 기초를 다지는 시간이 고등학교 3년을 결정합니다. 조급해하지 마세요.',
      '어설픈 선행보다 확실한 복습이 100배 효과적입니다.',
      '수학을 못하는 게 아니라, 아직 제대로 배우지 않은 것뿐입니다.',
      '중학교 개념만 확실히 잡아도 고등학교 수학의 절반은 해결됩니다.',
      '오늘 틀린 문제가 내일의 실력이 됩니다. 틀려도 괜찮아요.',
      '1등급 학생도 처음엔 기초부터 시작했습니다.',
      '포기하지 않는 것, 그것이 이미 절반의 성공입니다.',
      '쉬운 문제를 확실히 맞히는 것이 어려운 문제를 푸는 것보다 중요합니다.',
      '비교하지 마세요. 어제의 나보다 오늘의 내가 성장하면 됩니다.',
      "수학 자신감은 '할 수 있다'는 경험에서 옵니다. 작은 성공부터 쌓아가세요.",
      '개념을 이해하는 데 시간이 걸리는 건 당연한 일입니다. 천천히 가도 괜찮아요.',
      '문제집 여러 권을 대충 푸는 것보다, 한 권을 완벽히 마스터하세요.',
      "수학은 암기가 아니라 이해입니다. '왜?'라고 질문하는 습관을 들이세요.",
      '기초가 탄탄하면 응용은 자연스럽게 따라옵니다.',
      '지금 힘들어도 포기하지 않으면, 6개월 후 놀라운 변화를 경험할 거예요.',
      '수학 점수는 노력한 만큼 정직하게 오릅니다. 믿고 꾸준히 하세요.',
      '모르는 건 부끄러운 게 아닙니다. 모르는 척하는 게 부끄러운 겁니다.',
      '작은 성취가 모여 큰 자신감이 됩니다. 오늘 한 문제라도 제대로 이해하세요.',
      '수학을 싫어하는 게 아니라, 못한다고 생각해서 싫어하는 겁니다. 할 수 있어요!',
    ],
  },
  {
    level: '중위권',
    messages: [
      "중위권에서 상위권으로 가는 열쇠는 '개념의 왜'를 이해하는 것입니다.",
      "3등급과 1등급의 차이는 실력이 아니라 '디테일'입니다.",
      '지금 위치가 정체가 아니라 도약의 준비 단계입니다.',
      '같은 유형을 세 번 틀리면 개념으로 돌아가세요. 그것이 지름길입니다.',
      '꾸준함이 천재를 이깁니다. 매일 2시간씩 3개월이면 1등급도 가능합니다.',
      '공식을 외우지 말고, 공식이 왜 그렇게 되는지 이해하세요.',
      "오답노트는 쓰는 게 아니라 '보는 것'입니다. 시험 전 반드시 복습하세요.",
      "중위권의 가장 큰 적은 '대충 아는 것'입니다. 확실히 알거나, 모른다고 인정하세요.",
      '시험에서 아는 문제를 틀리는 것이 가장 아까운 실수입니다.',
      '기출문제는 출제자의 의도를 읽는 훈련입니다. 반드시 분석하세요.',
      '2등급에서 1등급으로 가는 데 필요한 건 5~10점, 충분히 가능한 목표입니다.',
      '실수는 실력입니다. 실수를 줄이는 것도 훈련이 필요합니다.',
      '문제를 많이 푸는 것보다, 틀린 문제를 제대로 분석하는 것이 중요합니다.',
      '수학은 스포츠와 같습니다. 매일 훈련해야 실력이 유지됩니다.',
      '지금 노력하면 내신과 수능, 두 마리 토끼를 다 잡을 수 있습니다.',
      '모의고사 성적에 일희일비하지 마세요. 추세가 중요합니다.',
      '어려운 문제를 고민하는 시간이 실력을 키웁니다. 바로 답을 보지 마세요.',
      '학교 선생님의 수업과 프린트가 내신의 80%입니다. 수업에 집중하세요.',
      '중위권은 가능성의 구간입니다. 어떻게 하느냐에 따라 1등급도, 4등급도 갈 수 있어요.',
      '지금 흘리는 땀이 시험장에서 여유가 됩니다. 오늘도 화이팅!',
    ],
  },
  {
    level: '상위권',
    messages: [
      "1등급 유지의 비결은 '아는 문제를 절대 틀리지 않는 것'입니다.",
      "상위권의 경쟁은 실력이 아니라 '컨디션 관리'입니다.",
      "만점과 98점의 차이는 실력이 아니라 '집중력'입니다.",
      '킬러 문항은 두 개 이상의 개념이 결합된 문제입니다. 개념 연결 훈련을 하세요.',
      '실수 노트를 만들어 자신만의 실수 패턴을 파악하세요.',
      '쉬운 문제에서 방심하는 순간, 등급이 바뀝니다.',
      '시험 시간의 마지막 10분 검토가 등급을 결정합니다.',
      '상위권일수록 기본으로 돌아가는 훈련이 필요합니다.',
      '1등급은 목표가 아니라 시작점입니다. 만점에 도전하세요.',
      "고난도 문제를 풀 때는 '왜 이 문제가 어려운가'를 분석하세요.",
      "서술형에서 감점되는 이유의 80%는 '과정 생략'입니다.",
      '실전처럼 연습하고, 연습처럼 실전에 임하세요.',
      '1점 차이로 등급이 갈릴 수 있습니다. 한 문제도 포기하지 마세요.',
      '자만은 실력의 적입니다. 항상 겸손하게 복습하세요.',
      '상위권의 슬럼프는 성장통입니다. 곧 더 높이 올라갈 거예요.',
      '기출 변형 문제를 많이 풀수록 시험장에서 당황하지 않습니다.',
      "계산 실수를 줄이는 가장 좋은 방법은 '천천히 정확하게' 푸는 습관입니다.",
      "문제를 풀고 나서 '다른 풀이는 없을까?' 고민하는 것이 실력을 키웁니다.",
      '1등급을 받는 것보다 1등급을 유지하는 것이 더 어렵습니다. 긴장을 놓지 마세요.',
      '지금의 노력이 대학뿐 아니라 평생의 사고력이 됩니다. 끝까지 최선을 다하세요!',
    ],
  },
  {
    level: '공통',
    messages: [
      '수학은 혼자 고민하는 시간이 실력이 됩니다.',
      '결과보다 과정을 칭찬해주세요. 노력하는 습관이 평생 갑니다.',
      '오늘 하루 최선을 다했다면, 그것으로 충분합니다.',
      '수학 성적은 거짓말을 하지 않습니다. 노력한 만큼 오릅니다.',
      '좋은 컨디션이 좋은 성적의 시작입니다. 충분히 자고 건강하게 공부하세요.',
      '선생님과 부모님은 항상 응원하고 있습니다. 힘내세요!',
      '한 문제를 제대로 이해하는 것이 열 문제를 대충 푸는 것보다 낫습니다.',
      '수학 공부에 왕도는 없지만, 정도(正道)는 있습니다. 꾸준함이 답입니다.',
      '시험은 끝이 아니라 다음 단계를 위한 점검입니다.',
      '함께 하면 더 멀리 갈 수 있습니다. 언제든 질문하세요!',
    ],
  },
];

/**
 * 수준별 격려 멘트 가져오기 (랜덤 1~2개)
 * @param level 학생 수준
 * @param count 가져올 멘트 개수 (기본 1개)
 * @param includeCommon 공통 멘트 포함 여부 (기본 true)
 */
export function getEncouragementMessages(
  level: '하위권' | '중위권' | '상위권',
  count: number = 1,
  includeCommon: boolean = true
): string[] {
  const levelMessages = ENCOURAGEMENT_MESSAGES.find(e => e.level === level)?.messages || [];
  const commonMessages = includeCommon
    ? ENCOURAGEMENT_MESSAGES.find(e => e.level === '공통')?.messages || []
    : [];

  const allMessages = [...levelMessages, ...commonMessages];

  // 랜덤 셔플 후 count개 선택
  const shuffled = allMessages.sort(() => Math.random() - 0.5);
  return shuffled.slice(0, Math.min(count, shuffled.length));
}

/**
 * 학년 기반 멘트 필터링 (중학생/고등학생 맞춤)
 * @param messages 원본 멘트 배열
 * @param grade 학년 (예: '중1', '고2')
 */
export function filterMessagesByGrade(messages: string[], grade: string): string[] {
  const isMiddleSchool = grade.startsWith('중');
  // isHighSchool은 향후 고등학생 전용 필터링에 사용 예정
  void grade.startsWith('고');

  return messages.map(msg => {
    // 고등학교 관련 멘트를 중학생에게 맞게 수정
    if (isMiddleSchool) {
      return msg
        .replace(/고등학교 3년/g, '중고등학교 시절')
        .replace(/고등학교 수학/g, '고등학교 진학 후 수학')
        .replace(/대학/g, '고등학교')
        .replace(/수능/g, '고입/내신');
    }
    return msg;
  });
}

/**
 * 시험 결과 기반 수준 추정
 * @param correctRate 정답률 (0~100)
 */
export function estimateLevel(correctRate: number): '하위권' | '중위권' | '상위권' {
  if (correctRate >= 80) return '상위권';
  if (correctRate >= 50) return '중위권';
  return '하위권';
}
