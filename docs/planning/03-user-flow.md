# User Flow (사용자 흐름도)

> Mermaid 플로우차트로 핵심 기능의 주요 여정을 표현합니다.
> 성공/실패 분기를 포함하고, 온보딩→핵심작업→리텐션 루프를 표현합니다.

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | 수학 시험지를 AI로 분석하여 일관되고 객관적인 분석 결과 제공 |
| 2 | 페르소나 | 학원 운영자, 선생님 (교육업계 종사자) |
| 3 | 핵심 기능 | FEAT-1: 문항별 분석 (난이도, 유형, 정답률) |
| 4 | 성공 지표 (노스스타) | AI 분석 정확도/일관성 |
| 5 | 입력 지표 | 주간 분석 횟수, 사용자 만족도 |
| 6 | 비기능 요구 | 분석 결과 일관성 (같은 시험지 = 같은 맥락의 결과) |
| 7 | Out-of-scope | 외부 연동 (소셜로그인, 결제), 실시간 협업 |
| 8 | Top 리스크 | OCR 인식 정확도 (이미지/PDF에서 문제 추출 실패) |
| 9 | 완화/실험 | 수동 입력 폴백, 사용자 피드백으로 모델 개선 |
| 10 | 다음 단계 | 문항별 분석 MVP 개발 |

---

## 1. 전체 사용자 여정 (Overview)

```mermaid
graph TD
    A[앱 진입] --> B{로그인 상태?}
    B -->|No| C[FEAT-0: 온보딩/로그인]
    B -->|Yes| D[대시보드]
    C --> D
    D --> E[FEAT-1: 시험지 업로드]
    E --> F[FEAT-1: 분석 요청]
    F --> G{분석 성공?}
    G -->|Yes| H[분석 결과 확인]
    G -->|No| I[에러 안내/재시도]
    I --> E
    H --> J[리포트 저장/공유]
    J --> K[리텐션 루프]
    K --> D
```

---

## 2. FEAT-0: 온보딩/로그인 플로우

```mermaid
graph TD
    A[시작 화면] --> B{신규/기존?}

    %% 신규 사용자
    B -->|신규| C[회원가입 선택]
    C --> D[이메일 입력]
    D --> E[비밀번호 설정]
    E --> F[닉네임 설정]
    F --> G[가입 완료]
    G --> H[온보딩 가이드]
    H --> I[대시보드]

    %% 기존 사용자
    B -->|기존| J[로그인]
    J --> K{로그인 성공?}
    K -->|Yes| I
    K -->|No| L[에러 표시]
    L --> J

    %% 비밀번호 찾기
    J --> M[비밀번호 찾기]
    M --> N[이메일 인증]
    N --> O[비밀번호 재설정]
    O --> J
```

### 온보딩 가이드 내용
1. "시험지 사진이나 PDF를 업로드하세요"
2. "AI가 문항별로 분석해드려요"
3. "분석 결과로 학습 방향을 잡으세요"

---

## 3. FEAT-1: 시험지 분석 플로우 (MVP 핵심)

```mermaid
graph TD
    A[대시보드] --> B[새 분석 시작]
    B --> C[시험지 업로드]

    C --> D{업로드 방식?}
    D -->|이미지| E[이미지 파일 선택]
    D -->|PDF| F[PDF 파일 선택]
    D -->|카메라| G[사진 촬영]

    E --> H[미리보기 확인]
    F --> H
    G --> H

    H --> I{파일 확인 OK?}
    I -->|No| C
    I -->|Yes| J[시험 정보 입력]

    J --> K[시험명 입력]
    K --> L[학년/단원 선택]
    L --> M[분석 요청]

    M --> N[분석 중... 로딩]
    N --> O{분석 성공?}

    O -->|Yes| P[분석 결과 화면]
    O -->|No| Q{에러 유형?}

    Q -->|이미지 품질| R[품질 개선 안내]
    Q -->|분석 실패| S[재시도 안내]
    Q -->|서버 오류| T[잠시 후 재시도]

    R --> C
    S --> M
    T --> M

    P --> U[문항별 분석 확인]
    U --> V{추가 작업?}
    V -->|저장| W[분석 저장]
    V -->|공유| X[리포트 내보내기]
    V -->|새 분석| B

    W --> A
    X --> A
```

---

## 4. 분석 결과 확인 플로우

```mermaid
graph TD
    A[분석 결과 화면] --> B[요약 카드]

    B --> C[총 문항 수]
    B --> D[난이도 분포]
    B --> E[유형별 분포]

    A --> F[문항별 상세]
    F --> G[문항 선택]
    G --> H[문항 상세 정보]

    H --> I[문항 번호]
    H --> J[난이도: 상/중/하]
    H --> K[유형: 계산/도형/응용...]
    H --> L[배점]
    H --> M[관련 단원]

    A --> N[전체 통계]
    N --> O[난이도 차트]
    N --> P[유형 차트]

    A --> Q[액션 버튼]
    Q --> R[저장하기]
    Q --> S[PDF 내보내기]
    Q --> T[수정하기]
```

---

## 5. 학생 답안 분석 플로우 (v2 예정)

```mermaid
graph TD
    A[시험지 분석 완료] --> B{학생 답안 추가?}

    B -->|Yes| C[학생 답안지 업로드]
    B -->|No| D[분석 결과만 저장]

    C --> E[학생 정보 입력]
    E --> F[이름/번호]

    F --> G[답안 인식 중...]
    G --> H{인식 성공?}

    H -->|Yes| I[정답/오답 표시]
    H -->|No| J[수동 입력 요청]

    I --> K[학생별 분석]
    J --> K

    K --> L[정답률]
    K --> M[틀린 문항 목록]
    K --> N[취약 유형 분석]

    N --> O[취약점 리포트]
    O --> P[학습 추천]
```

---

## 6. 리텐션 루프 (습관 형성)

```mermaid
graph TD
    A[분석 완료] --> B[즉각 피드백]
    B --> C["분석이 완료되었습니다!"]

    C --> D[분석 이력 저장]
    D --> E[다음 분석 유도]
    E --> F["다른 시험지도 분석해보세요"]

    %% 재방문 유도
    G[시간 경과] --> H{알림 설정?}
    H -->|Yes| I[이메일/푸시 알림]
    I --> J["이번 주 시험 분석하셨나요?"]
    J --> K[앱 재진입]
    K --> A

    H -->|No| L[자연 재방문]
    L --> A

    %% 분석 이력 활용
    D --> M{이전 분석 있음?}
    M -->|Yes| N[성장 추이 표시]
    N --> O["지난달보다 분석량 20% 증가!"]
    M -->|No| P[첫 분석 축하]
```

---

## 7. 에러 처리 플로우

```mermaid
graph TD
    A[에러 발생] --> B{에러 유형?}

    B -->|네트워크| C[연결 재시도 안내]
    B -->|파일 형식| D[지원 형식 안내]
    B -->|파일 크기| E[크기 제한 안내]
    B -->|분석 실패| F[분석 실패 안내]
    B -->|서버 오류| G[잠시 후 재시도 안내]

    C --> H{재시도?}
    H -->|Yes| I[재시도 실행]
    H -->|No| J[오프라인 안내]

    D --> K["이미지(JPG, PNG) 또는 PDF만 가능"]
    K --> L[파일 재선택]

    E --> M["최대 10MB까지 가능"]
    M --> N[파일 압축 안내]
    N --> L

    F --> O[분석 재시도 or 수동 입력]
    O --> P{선택?}
    P -->|재시도| Q[재분석 요청]
    P -->|수동 입력| R[수동 입력 화면]

    G --> S[고객센터 안내]
```

---

## 8. 화면 목록 (Screen Inventory)

| 화면 ID | 화면명 | FEAT | 진입점 | 주요 액션 |
|---------|--------|------|--------|----------|
| S-01 | 랜딩 페이지 | - | URL 진입 | 로그인/가입 선택 |
| S-02 | 로그인 | FEAT-0 | S-01 | 이메일 로그인 |
| S-03 | 회원가입 | FEAT-0 | S-01 | 계정 생성 |
| S-04 | 온보딩 가이드 | FEAT-0 | S-03 | 서비스 소개 확인 |
| S-05 | 대시보드 | - | S-02, S-04 | 새 분석, 이력 조회 |
| S-06 | 시험지 업로드 | FEAT-1 | S-05 | 파일 업로드 |
| S-07 | 시험 정보 입력 | FEAT-1 | S-06 | 시험명, 학년 입력 |
| S-08 | 분석 중 (로딩) | FEAT-1 | S-07 | 대기 |
| S-09 | 분석 결과 | FEAT-1 | S-08 | 결과 확인, 저장 |
| S-10 | 분석 상세 | FEAT-1 | S-09 | 문항별 상세 확인 |
| S-11 | 분석 이력 | - | S-05 | 과거 분석 조회 |
| S-12 | 에러 화면 | - | 전체 | 에러 안내, 재시도 |

---

## 9. 화면별 와이어프레임 개요

### S-05: 대시보드

```
┌─────────────────────────────────────────┐
│  [Logo]          수학 시험지 분석기  [👤]  │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │     + 새 시험지 분석하기         │   │
│  └─────────────────────────────────┘   │
│                                         │
│  최근 분석                               │
│  ┌─────────────────────────────────┐   │
│  │ 중2 1학기 중간고사  │ 2024-01-15 │   │
│  │ 30문항 │ 분석완료                │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │ 중3 기하 단원평가   │ 2024-01-10 │   │
│  │ 20문항 │ 분석완료                │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### S-06: 시험지 업로드

```
┌─────────────────────────────────────────┐
│  ← 새 분석                              │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │     📄 시험지를 업로드하세요     │   │
│  │                                 │   │
│  │   이미지(JPG, PNG) 또는 PDF     │   │
│  │   최대 10MB                     │   │
│  │                                 │   │
│  │   [파일 선택] [카메라 촬영]     │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  💡 팁: 선명한 이미지일수록 분석이      │
│     정확해요!                           │
│                                         │
└─────────────────────────────────────────┘
```

### S-09: 분석 결과

```
┌─────────────────────────────────────────┐
│  ← 분석 결과                    [저장]  │
├─────────────────────────────────────────┤
│                                         │
│  중2 1학기 중간고사                      │
│  분석일: 2024-01-15                     │
│                                         │
│  ┌──────────┬──────────┬──────────┐   │
│  │ 총 문항  │ 평균난이도│ 주요유형  │   │
│  │   30개   │   중     │   계산    │   │
│  └──────────┴──────────┴──────────┘   │
│                                         │
│  난이도 분포          유형 분포          │
│  ┌────────┐          ┌────────┐       │
│  │ 📊     │          │ 📊     │       │
│  │ 차트   │          │ 차트   │       │
│  └────────┘          └────────┘       │
│                                         │
│  문항별 상세 >                          │
│  ┌─────────────────────────────────┐   │
│  │ 1번 │ 상 │ 계산 │ 3점          │   │
│  │ 2번 │ 중 │ 도형 │ 4점          │   │
│  │ 3번 │ 하 │ 계산 │ 3점          │   │
│  │ ...                              │   │
│  └─────────────────────────────────┘   │
│                                         │
│  [PDF 내보내기]  [새 분석하기]          │
│                                         │
└─────────────────────────────────────────┘
```

---

## Decision Log 참조

| ID | 항목 | 선택 | 근거 |
|----|------|------|------|
| UX-01 | 업로드 방식 | 드래그앤드롭 + 파일선택 + 카메라 | 모바일/PC 모두 편리 |
| UX-02 | 분석 피드백 | 로딩 + 진행률 표시 | 사용자 이탈 방지 |
| UX-03 | 에러 처리 | 명확한 안내 + 대안 제시 | 사용자 좌절 방지 |
